/* /////////////////////////////////////////////////////
 * Captions module for ddGM
 * v 1.0 :: 2012-10-02
//////////////////////////////////////////////////////*/
(function(){var b="captions",a={fadeSpeed:undefined,fadeOutSpeed:375,fadeInSpeed:750,internal:true,toControl:true,selectors:"",hide:true,hideDelay:2000,slideSpeed:undefined,slideOutSpeed:375,slideInSpeed:750,showOnChange:true,showOnHover:true},c={initialize:function(e){var d=this,i="",f="",g=$(),j=$(),h=$();d.opt.modules[b]=$.extend(a,d.opt.modules[b]);d.opt.modules[b].fadeInSpeed=(d.opt.modules[b].fadeSpeed==undefined)?d.opt.modules[b].fadeInSpeed:d.opt.modules[b].fadeSpeed;d.opt.modules[b].fadeOutSpeed=(d.opt.modules[b].fadeSpeed==undefined)?d.opt.modules[b].fadeOutSpeed:d.opt.modules[b].fadeSpeed;d.opt.modules[b].slideInSpeed=(d.opt.modules[b].slideSpeed==undefined)?d.opt.modules[b].slideInSpeed:d.opt.modules[b].slideSpeed;d.opt.modules[b].slideOutSpeed=(d.opt.modules[b].slideSpeed==undefined)?d.opt.modules[b].slideOutSpeed:d.opt.modules[b].slideSpeed;i='<div class="ddGM-caption-wrapper" style="overflow:hidden" />';f='<span class="ddGM-caption">&nbsp;</span>';if(d.opt.modules[b].internal){g=(d.opt.modules[b].toControl)?g.add(d.obj.control):g.add(d.gal)}if(d.opt.modules[b].selectors){j=j.add(d.opt.modules[b].selectors)}h=h.add(g).add(j);h.append(i).ready(function(){d.obj.capWrapAll=h.find(".ddGM-caption-wrapper");d.obj.capWrapInternal=$();if(d.opt.modules[b].internal){d.obj.capWrapInternal=d.gal.find(".ddGM-caption-wrapper");d.obj.capWrapInternal.css({zIndex:d.layers.indicators,position:(d.opt.modules[b].toControl?"":"position:absolute;"),width:"100%",height:0})}d.obj.capWrapExternal=$();if(d.opt.modules[b].selectors){d.obj.capWrapExternal=h.not(d.obj.control).not(d.gal).find(".ddGM-caption-wrapper")}d.obj.capWrapAll.html(f).ready(function(){d.obj.capAll=d.obj.capWrapAll.find(".ddGM-caption");d.obj.capInternal=d.obj.capWrapInternal.find(".ddGM-caption");d.obj.capExternal=d.obj.capWrapExternal.find(".ddGM-caption");d.registerEvent("changeStart",b,"changeCap");d.registerEvent("midAnim",b,"showCap");d.registerEvent("loadEnd",b,"changeCap");if(d.opt.modules[b].internal){if(d.opt.modules[b].hide){d.registerEvent("changeEnd",b,"startTimer");if(d.opt.modules[b].showOnHover){d.registerEvent("changeStart",b,"showCap")}if(d.opt.modules[b].showOnHover){d.registerEvent("mouseIn",b,"showCap");d.registerEvent("touchEndUp",b,"hideCap");d.registerEvent("mouseOut",b,"startTimer")}}else{d.registerEvent("loadEnd",b,"showCap");d.registerEvent("changeStart",b,"showCap")}d.states.capHidden=true;d.states.capHeight=0}d.registerEvent("unload",b,"unload");if(e!=null){e.resolve()}})})},changeCap:function(e){var d=this,g=d.obj.capAll.html(),f=d.items[d.states.clicked!=""?d.states.clicked:d.states.current].caption;switch(f){case undefined:case"":case" ":f="&nbsp;"}d.obj.capAll.stop(1,1).css({opacity:0}).html(f);d.states.capHeight=d.obj.capInternal.outerHeight();d.obj.capAll.html(g).css({opacity:1}).animate({opacity:0},d.opt.modules[b].fadeOutSpeed,function(){$(this).html(f).animate({opacity:1},d.opt.modules[b].fadeInSpeed)});if(e!=null){e.resolve()}},hideCap:function(e){var d=this;clearTimeout(d.timers.capTimer);d.obj.capWrapInternal.stop(1,0).animate({height:0},d.opt.modules[b].slideOutSpeed);d.states.capHidden=true;if(e!=null){e.resolve()}},showCap:function(e){var d=this,g=false,h=(d.states.clicked!="")?d.states.clicked:d.states.current,f=d.items[h].caption;clearTimeout(d.timers.capTimer);switch(f){case undefined:case null:case"":case" ":case"&nbsp;":g=true}if(g){window.ddGM.modules[b].hideCap.call(d,null);return}d.obj.capWrapInternal.stop(1,0).animate({height:d.states.capHeight},d.opt.modules[b].slideInSpeed);d.states.capHidden=false;if(e!=null){e.resolve()}},startTimer:function(e){var d=this;if(d.opt.modules[b].hide&&(!d.states.hover||!d.opt.modules[b].showOnHover)){clearTimeout(d.timers.capTimer);d.timers.capTimer=setTimeout(function(){window.ddGM.modules[b].hideCap.call(d,null)},d.opt.modules[b].hideDelay)}if(e!=null){e.resolve()}},unload:function(e){var d=this;clearTimeout(d.timers.capTimer);d.obj.capWrapAll.remove();if(e!=null){e.resolve()}}};if(!window.ddGM){window.ddGM={}}if(!window.ddGM.modules){$.extend(window.ddGM,{modules:{}})}window.ddGM.modules[b]=c})();