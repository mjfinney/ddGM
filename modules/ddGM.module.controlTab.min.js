/* /////////////////////////////////////////////////////
 * Control Tab module for ddGM
 * v 1.0 :: 2012-10-02
//////////////////////////////////////////////////////*/
(function(){var b="controlTab",a={startPinned:false,speed:250,center:true},c={initialize:function(e){var d=this,f='<div class="ddGM-control-wrap" />',g='<a class="ddGM-control-tab" />';d.opt.modules[b]=$.extend(a,d.opt.modules[b]);d.obj.control.wrap(f).ready(function(){d.obj.controlWrap=d.obj.control.parent(".ddGM-control-wrap");d.obj.controlWrap.css({"z-index":d.layers.controls});d.obj.controlWrap.append(g).ready(function(){d.obj.controlTab=d.obj.controlWrap.children(".ddGM-control-tab").css({"z-index":d.layers.top});d.states.controlTab=true;d.obj.control.css({position:"relative"});if(d.opt.modules[b].startPinned){d.states.controlPins={user:true};d.states.controlPinned=true;d.registerEvent("loadStart",b,"pinOnLoad")}else{d.states.controlPins={user:false};d.states.controlPinned=false}if(d.opt.modules[b].center){d.registerEvent("loadStart",b,"center");d.registerEvent("resize",b,"center")}d.obj.controlTab.on("click",function(){if(d.states.controlPinned){window.ddGM.modules[b].unpin.call(d,"user")}else{window.ddGM.modules[b].pin.call(d,"user")}});e.resolve()})})},pinOnLoad:function(d){window.ddGM.modules[b].pin.call(this,"user");d.resolve()},pin:function(e){var d=this;d.states.controlPins[e]=true;d.states.controlPinned=true;d.obj.control.animate({height:0},d.opt.modules[b].speed).addClass("pinned")},unpin:function(e){var d=this,f=true,g,h;if(e=="user"){d.states.controlPins={user:false}}else{$.each(d.states.controlPins,function(k,j){if(k==e){d.states.controlPins[k]=false}else{if(j){f=false}}})}if(f){d.states.controlPinned=false;g=d.obj.control.stop(1,0).height();h=d.obj.control.css({opacity:0,height:""}).height();d.obj.control.css({opacity:1,height:g}).animate({height:h},d.opt.modules[b].speed,function(){$(this).css({height:""}).removeClass("pinned")})}},center:function(f){var e=this,d=e.obj.controlWrap.width(),g=e.obj.controlTab.outerWidth();e.obj.controlTab.css({left:Math.round((d/2)-(g/2))});if(f!=null){f.resolve()}}};if(!window.ddGM){window.ddGM={}}if(!window.ddGM.modules){$.extend(window.ddGM,{modules:{}})}window.ddGM.modules[b]=c})();