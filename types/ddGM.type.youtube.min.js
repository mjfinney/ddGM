(function(){var e="youtube",t={autoPlay:false,playnext:false,autoPin:true,APIThumb:"default",APIParams:{}},a={initialize:function(a){var i=this;i.opt.types[e]=$.extend(t,i.opt.types[e]);if(i.opt.types[e].APIParams.wmode==undefined){i.opt.types[e].APIParams.wmode="opaque"}if(typeof window.onYouTubeIframeAPIReady!="function"){$.ajax({url:"//www.youtube.com/iframe_api",type:"GET",dataType:"script"});i.registerEvent("postAnim",e,"changeItem","type");if(i.opt.types[e].autoPlay||i.opt.types[e].playnext){i.registerEvent("changeEnd",e,"autoPlay","type")}window.onYouTubeIframeAPIReady=function(){a.resolve()}}else{a.resolve()}},selector:function(t,a){var i=this,o,n;if(t.is("iframe")||t.is("div")&&t.data("type")=="youtube"){a.video=t.is("iframe")?window.ddGM.types[e].setVideo.call(i,t.attr("src")):t.data("video");if(a.video){a.thumb=window.ddGM.types[e].setThumb.call(i,t.data("thumb"),a.video);o=t.attr("title")==undefined?t.data("title"):t.attr("title");window.ddGM.types[e].setText.call(i,{title:o,cap:t.data("caption")},a)}else{return false}}else if(t.is("ul")&&t.data("type")=="youtube"){a.video=window.ddGM.types[e].setVideo.call(i,t.children('[data-item="content"]').children("iframe").attr("src"));if(a.video){a.extended=t.children('[data-item="extended"]').length>0?t.children('[data-item="extended"]').html():"";a.thumb=window.ddGM.types[e].setThumb.call(i,t.data("thumb"),a.video);n=t.children('[data-item="caption"]').length>0?t.children('[data-item="caption"]').html():"";o=t.children('[data-item="content"]').children("iframe").attr("title")||"";window.ddGM.types[e].setText.call(i,{title:o,cap:n},a)}else{return false}}else{return false}return true},setVideo:function(e){var t=e.match(/(?:http\:|)\/\/(?:www\.|)(youtube)\.co(?:m|\.[a-zA-Z]{2}|)\/.*(?:v=|video\/|embed\/)(.{11})/i)||["","",""];if(t[1].toLowerCase()=="youtube"){return t[2]}else{return false}},setThumb:function(t,a){var i=this,o=["default","hqdefault","mqdefault","maxresdefault","0","1","2","3"];if(t==undefined){return"//img.youtube.com/vi/"+a+"/"+i.opt.types[e].APIThumb+".jpg"}else if($.inArray(t.toString(),o)>=0){return"//img.youtube.com/vi/"+a+"/"+t+".jpg"}else{return t||""}},setText:function(t,a){var i=this,o=function(o){a.title=t.title?t.title:o;a.caption=t.cap?t.cap:o;window.ddGM.types[e].builder.call(i,a)};if(t.title==undefined||t.cap==undefined){$.ajax({url:"https://gdata.youtube.com/feeds/api/videos/"+a.video,data:{v:2,alt:"json",fields:"title"},dataType:"json",success:function(e){o(e.entry.title.$t)},error:function(){o("")}})}else{o("")}},builder:function(t){var a=this;t.content+='<div data-type="'+e+'" class="ddGM-item '+t.id+'" style="position:absolute;width:100%;height:100%;top:0;left:0;">';t.content+='<div id="'+t.id+'-youtube"></div>';t.content+="</div>";a.addItem(t)},loader:function(t,a,i){var o=this,n=a.id;i.append(a.content).ready(function(){o.items[n].youtube=new window["YT"].Player(n+"-youtube",{height:"100%",width:"100%",videoId:a.video,playerVars:o.opt.types[e].APIParams,events:{onReady:function(e){o.items[n].youtubeReady=true},onStateChange:function(t){window.ddGM.types[e].playerChange.call(o,t,n)}}});t.resolve()})},playerChange:function(t,a){var i=this;switch(t.data){case window["YT"].PlayerState.BUFFERING:case window["YT"].PlayerState.PLAYING:i.pause.call(i,"youtube");if(i.opt.types[e].playnext){i.play.call(i,"youtubePlaynext")};clearTimeout(i.timers.youtubeDelay);i.timers.youtubeDelay=false;if(i.states.controlTab&&i.opt.types[e].autoPin){window.ddGM.modules.controlTab.pin.call(i,"youtube");if(i.opt.types[e].playnext){window.ddGM.modules.controlTab.unpin.call(i,"youtubePlaynext")}};i.items[i.states.current].youtubeStarted=true;i.states.youtubeEnded=false;break;case window["YT"].PlayerState.PAUSED:if(!i.timers.youtubeDelay){i.timers.youtubeDelay=setTimeout(function(){i.timers.youtubeDelay=false;if(i.states.controlTab&&i.opt.types[e].autoPin){window.ddGM.modules.controlTab.unpin.call(i,"youtube")}i.play.call(i,"youtube")},500)};break;case window["YT"].PlayerState.ENDED:i.states.youtubeEnded=true;clearTimeout(i.timers.youtubeDelay);i.timers.youtubeDelay=false;if(i.states.controlTab&&i.opt.types[e].autoPin){window.ddGM.modules.controlTab.unpin.call(i,"youtube")};i.play.call(i,"youtube");if(i.opt.types[e].playnext){if(i.states.controlTab&&i.opt.types[e].autoPin){window.ddGM.modules.controlTab.pin.call(i,"youtubePlaynext")}i.pause.call(i,"youtubePlaynext");i.rotateItems.call(i,true)};break}},autoPlay:function(t){var a=this,i=a.items[a.states.current],o=function(){if(a.opt.types[e].autoPlay=="always"||a.opt.types[e].autoPlay&&!i.youtubeStarted||a.opt.types[e].playnext&&a.states.youtubeEnded){if(a.opt.types[e].playnext&&a.states.youtubeEnded){i.youtube.seekTo(0,true)}window.ddGM.types[e].play.call(a,a.states.current);a.states.youtubeEnded=false}t.resolve()};if(i.type!="youtube"){t.resolve();return}if(i.youtubeReady){o()}else{a.timers.youtubeLoading=setInterval(function(){if(i.youtubeReady){clearInterval(a.timers.youtubeLoading);o()}},100)}},changeItem:function(t){var a=this;$.each(a.items,function(t,i){window.ddGM.types[e].pause.call(a,t)});if(t!=null){t.resolve()}},play:function(e){var t=this,a=t.items[e];if(a.youtubeReady){a.youtube.playVideo()}},pause:function(e){var t=this,a=t.items[e];if(a.youtubeReady){a.youtube.pauseVideo()}}};if(!window.ddGM){window.ddGM={}}if(!window.ddGM.types){$.extend(window.ddGM,{types:{}})}window.ddGM.types[e]=a})();